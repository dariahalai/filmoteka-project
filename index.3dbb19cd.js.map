{"mappings":"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","sources":["src/js/trailer.js","src/index.js","src/js/open-model.js"],"sourcesContent":["import { getMovieTrailer } from './popular';\n\nexport const trailerButtonRef = document.getElementById('trailer');\nconst trailerErrorContainer = document.getElementById('trailer-error');\nconst spinner = document.querySelector('.spinner');\n\nif (!trailerButtonRef) {\n  return;\n}\n\nexport const handleBackButtonClick = (iframeContainer, trailerContainer) => {\n  trailerContainer.classList.remove('display-none');\n  trailerErrorContainer.innerHTML = '';\n  if (iframeContainer) {\n    iframeContainer.remove();\n  }\n};\n\nconst renderYoutubeIframe = movieKey => {\n  const iframe = document.createElement('iframe');\n  iframe.src = `https://www.youtube.com/embed/${movieKey}`;\n  iframe.frameBorder = '0';\n  iframe.allowFullscreen = true;\n  const trailerContainer = document.querySelector('.film__info-wrapper');\n  trailerContainer.classList.add('display-none');\n  const iframeContainer = document.createElement('div');\n  iframeContainer.classList.add('iframe-container');\n  iframeContainer.setHTML(\n    '<button class=\"back-button\" id=\"back-to-modal\">BACK</button>'\n  );\n  trailerContainer.after(iframeContainer);\n  const backButton = document.getElementById('back-to-modal');\n  backButton.addEventListener('click', () => {\n    handleBackButtonClick(iframeContainer, trailerContainer);\n    backButton.removeEventListener('click', handleBackButtonClick);\n  });\n  iframeContainer.appendChild(iframe);\n};\n\nexport const handleTrailerButtonClick = () => {\n  spinner.classList.remove('is-hidden');\n  const movieId = trailerButtonRef.getAttribute('data-movie-id');\n  getMovieTrailer(movieId)\n    .then(data => {\n      const results = data.results;\n      if (!results.length) {\n        throw new Error('Trailer is not available');\n      }\n      renderYoutubeIframe(results[0].key);\n    })\n    .catch(e => {\n      trailerErrorContainer.innerText = e.message;\n    })\n    .finally(() => {\n      spinner.classList.add('is-hidden');\n    });\n};\n\ntrailerButtonRef.addEventListener('click', handleTrailerButtonClick);\n","import './js/pagination';\nimport './js/popular';\nimport './js/film-search';\nimport './js/open-model';\nimport './js/trailer';\nimport './js/modal-team';\nimport './js/btn-scroll';\n\n\n","import * as storageLocal from './local-storage.js';\nimport ModalFilm from './modal-film';\nimport { handleBackButtonClick, trailerButtonRef,  handleTrailerButtonClick} from './trailer';\n\nimport { sendWatchedToStorage, sendQueueToStorage } from \"./local-storage-set\";\n\nconst refs = {\n  gallery: document.querySelector('.js-gallery'),\n  closeBtn: document.querySelector('[data-modal-close]'),\n  btnWatched: document.querySelector(\".btn_watched\"),\n  btnQueue: document.querySelector(\".btn_queue\"),\n};\n\nconst modalFilm = new ModalFilm();\n\nrefs.gallery.addEventListener('click', onOpenModal);\nrefs.closeBtn.addEventListener('click', onCloseModal);\nwindow.addEventListener('keydown', onCloseModalEsc);  \n\nfunction onOverlayClose(event) {\n  if (!event.target.closest(\".modal\") && event.target.closest('.backdrop')) {\n      onCloseModal();\n  }\n}\ndocument.addEventListener(\"click\", onOverlayClose)\n\nfunction onOpenModal(e) {\n  e.preventDefault();\n  trailerButtonRef.addEventListener('click', handleTrailerButtonClick);\n\n  if (e.target.nodeName !== 'IMG') return;\n\n  const dataCurentFilm = getFilmData(e.target.id);\n\n  modalFilm.modifyDataFilm(dataCurentFilm);\n  modalFilm.open();\n\n///// for local-storage and button /////////\n  checkWatchedStorage(dataCurentFilm)\n  if (refs.btnWatched.classList.contains(\"watched_remove\")) {\n      refs.btnWatched.textContent = 'REMOVE FROM WATCHED'\n  } \n\n  checkQueueStorage(dataCurentFilm)\n  if (refs.btnQueue.classList.contains(\"queue_remove\")) {\n      refs.btnQueue.textContent = 'REMOVE FROM QUEUE'\n  } \n  \n  refs.btnWatched.addEventListener(\"click\", onWatchedBtnClick)\n  refs.btnQueue.addEventListener(\"click\", onQueueBtnClick)\n    \n  \n  function onWatchedBtnClick() {\n    // connst filmData = dataCurentFilm\n    if (refs.btnWatched.classList.contains(\"watched_send\")) {\n      refs.btnWatched.textContent = 'REMOVE FROM WATCHED'\n      refs.btnWatched.classList.replace(\"watched_send\", \"watched_remove\")\n\n      sendWatchedToStorage(dataCurentFilm)\n    } else if (refs.btnWatched.classList.contains(\"watched_remove\")) {\n      refs.btnWatched.textContent = 'ADD TO WATCHED'  \n      refs.btnWatched.classList.replace(\"watched_remove\", \"watched_send\")\n\n      removeWatchedFilm(dataCurentFilm)\n    } \n  }\n \n  function removeWatchedFilm(currentFilm) {\n      try {\n        const getWatchedFromStorage = localStorage.getItem(\"WatchedMovies\")\n        const getWatchedArray = JSON.parse(getWatchedFromStorage)\n\n        const watchedFilmIndex = getWatchedArray.findIndex(value => value.id === currentFilm.id);\n        getWatchedArray.splice(watchedFilmIndex, 1)\n        localStorage.setItem(\"WatchedMovies\", JSON.stringify(getWatchedArray))\n        \n        refs.btnWatched.classList.replace(\"watched_remove\", \"watched_send\")\n\n    } catch (error) {\n      console.error('Get state error: ', error.message);\n    }\n}\n  \n  function onQueueBtnClick() {\n    if (refs.btnQueue.classList.contains(\"queue_send\")) {\n      refs.btnQueue.textContent = 'REMOVE FROM QUEUE'\n      refs.btnQueue.classList.replace(\"queue_send\", \"queue_remove\")\n\n      sendQueueToStorage(dataCurentFilm)\n    } else if (refs.btnQueue.classList.contains(\"queue_remove\")) {\n      refs.btnQueue.textContent = 'ADD TO QUEUE'  \n      refs.btnQueue.classList.replace(\"queue_remove\", \"queue_send\")\n\n      removeQueueFilm(dataCurentFilm)\n    } \n  }\n\n  function removeQueueFilm(currentFilm) {\n      try {\n        const getQueueFromStorage = localStorage.getItem(\"QueueMovies\")\n        const getQueueArray = JSON.parse(getQueueFromStorage)\n\n        const QueueFilmIndex = getQueueArray.findIndex(value => value.id === currentFilm.id);\n        getQueueArray.splice(QueueFilmIndex, 1)\n        localStorage.setItem(\"QueueMovies\", JSON.stringify(getQueueArray))\n        \n        refs.btnQueue.classList.replace(\"queue_remove\", \"queue_send\")\n\n    } catch (error) {\n      console.error('Get state error: ', error.message);\n    }\n}\n///////////////////end of local-storage ///////////\n\n  refs.closeBtn.addEventListener('click', onCloseModal);\n  window.addEventListener('keydown', onCloseModalEsc);\n}\n\nfunction onCloseModal() {\n  const iframeContainer = document.querySelector('.iframe-container');\n  const trailerContainer = document.querySelector('.film__info-wrapper');\n  handleBackButtonClick(iframeContainer, trailerContainer);\n  modalFilm.close();\n  refs.closeBtn.removeEventListener('click', onCloseModal);\n  trailerButtonRef.removeEventListener('click', handleTrailerButtonClick);\n  window.removeEventListener('keydown', onCloseModalEsc);\n\n    ////////////////////\n  // refs.btnWatched.removeEventListener(\"click\", onWatchedBtnClick)\n  // refs.btnQueue.removeEventListener(\"click\", onQueueBtnClick)\n\n\n  //////////Примусове перезавантаження сторінки /////////////////////////////////\n  // window.location.reload()\n}\n\nfunction onCloseModalEsc(e) {\n  if (e.code === 'Escape') {\n    modalFilm.close();\n\n    refs.closeBtn.removeEventListener('click', onCloseModal);\n    window.removeEventListener('keydown', onCloseModalEsc);\n  }\n}\n\nfunction getFilmData(filmId) {\n  const filmList = storageLocal.load('film-current-page');\n  return filmList.find(film => film.id === Number(filmId));\n}\n\n////////////// checks for button /////////////////\n\nfunction checkWatchedStorage(currentFilm) {\n  try {\n    const getWatchedFromStorage = localStorage.getItem(\"WatchedMovies\")\n    const getWatchedArray = JSON.parse(getWatchedFromStorage)\n    const checkWatchedStorage = getWatchedArray.find(option => option.id === currentFilm.id);\n        if (checkWatchedStorage) {\n          refs.btnWatched.classList.replace(\"watched_send\", \"watched_remove\")\n        } else {\n          refs.btnWatched.classList.replace(\"watched_remove\", \"watched_send\")\n        }\n    } catch (error) {\n      console.error('Get state error: ', error.message);\n      refs.btnWatched.classList.replace(\"watched_remove\", \"watched_send\")\n    }\n}\n\nfunction checkQueueStorage(currentFilm) {\n  try {\n    const getQueueFromStorage = localStorage.getItem(\"QueueMovies\")\n    const getQueueArray = JSON.parse(getQueueFromStorage)\n    const checkQueueStorage = getQueueArray.find(option => option.id === currentFilm.id);\n        if (checkQueueStorage) {\n          refs.btnQueue.classList.replace(\"queue_send\", \"queue_remove\")\n        } else {\n          refs.btnQueue.classList.replace(\"queue_remove\", \"queue_send\")\n        }\n    } catch (error) {\n      console.error('Get state error: ', error.message);\n      refs.btnQueue.classList.replace(\"queue_remove\", \"queue_send\")\n    }\n}\n"],"names":["$lU18B","parcelRequire","trailerButtonRef","document","getElementById","trailerErrorContainer","spinner","querySelector","handleBackButtonClick","iframeContainer","trailerContainer","classList","remove","innerHTML","handleTrailerButtonClick","movieId","getAttribute","getMovieTrailer","then","data","results","length","Error","movieKey","iframe","createElement","src","frameBorder","allowFullscreen","add","setHTML","after","backButton","addEventListener","removeEventListener","appendChild","renderYoutubeIframe","key","catch","e","innerText","message","finally","$b5rV1","$95c314e50c7458b5$var$refs","gallery","closeBtn","btnWatched","btnQueue","$95c314e50c7458b5$var$modalFilm","$fQE3M","default","$95c314e50c7458b5$var$onCloseModal","$37v9V","close","window","$95c314e50c7458b5$var$onCloseModalEsc","code","preventDefault","target","nodeName","dataCurentFilm","filmId","id","load","find","film","Number","modifyDataFilm","open","currentFilm","getWatchedFromStorage","localStorage","getItem","getWatchedArray","JSON","parse","option","replace","error","console","$95c314e50c7458b5$var$checkWatchedStorage","contains","textContent","getQueueFromStorage","getQueueArray","$95c314e50c7458b5$var$checkQueueStorage","$9dykO","sendWatchedToStorage","watchedFilmIndex","findIndex","value","splice","setItem","stringify","removeWatchedFilm","sendQueueToStorage","QueueFilmIndex","removeQueueFilm","event","closest"],"version":3,"file":"index.3dbb19cd.js.map"}